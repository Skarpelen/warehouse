@page "/units/form/{Id:guid}"
@using Warehouse.Client.Components
@using Warehouse.Client.Services
@using Warehouse.Shared.DTO
@inject IApiAccess Api

<CrudForm TDto="UnitDTO"
          Title="Единица измерения"
          Id="@Id"
          ReturnUrl="/units"
          LoadFunc="async id => await Api.GetUnit(id).ContinueWith(t => (t.Result.Result, t.Result.Response))"
          SaveFunc="async dto => (Id == Guid.Empty
                                                     ? (await Api.CreateUnit(dto))
                                                     : (await Api.UpdateUnit(dto)))"
          DeleteFunc="async id => (await Api.DeleteUnit(id))"
          ArchiveFunc="async id => (await Api.ArchiveUnit(id))"
          UnarchiveFunc="async id => (await Api.UnarchiveUnit(id))">
    <Template Context="model">
        <MudTextField Label="Наименование" @bind-Value="model.Name" />
    </Template>
</CrudForm>

@code {
    [Parameter] public Guid Id { get; set; }
}